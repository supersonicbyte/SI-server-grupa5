{
    "openapi": "3.0.0",
    "info": {
        "version": "1.0.0",
        "title": "Main server to MWA interface /interakcija",
        "description": "NodeJS",
        "license": {
            "name": "si-grupa5.herokuapp.com",
            "url": "https://si-grupa5.herokuapp.com/"
        }
    },
    "servers": [
        {
            "url": "https://si-grupa5.herokuapp.com"
        }
    ],
    "tags": [
        {
            "name": "Screenshot"
        },
        {
            "name": "Command"
        },
        {
            "name": "Agent"
        },
        {
            "name": "Files"
        }
    ],
    "consumes": [
        "application/json"
    ],
    "produces": [
        "application/json"
    ],
    "schemes": ["https"],
    "paths": {
        "/api/screenshot": {
            "post": {
                "tags": [
                    "Screenshot"
                ],
                "summary": "Screenshot from agent",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/screenshot"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "404": {
                        "description": "Agent is not connected to the server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error404"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/command": {
            "post": {
                "tags": [
                    "Command"
                ],
                "summary": "Execute a command on the agent",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/command"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "404": {
                        "description": "Agent is not connected to the server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error404"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/agent/disconnect": {
            "post": {
                "tags": [
                    "Agent"
                ],
                "summary": "Disconnect a client",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/agent"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/disconnected"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Agent can't be disconnected",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Device is not found!"
                                        },
                                        "name": {
                                            "type":"string",
                                            "example": "Agent"
                                        },
                                        "location": {
                                            "type":"string",
                                            "example": "City"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/agent/connect": {
            "post": {
                "tags": [
                    "Agent"
                ],
                "summary": "Connect a client",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/agent"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/connected"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Agent can't be connected",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Device is not found!"
                                        },
                                        "name": {
                                            "type":"string",
                                            "example": "Agent"
                                        },
                                        "location": {
                                            "type":"string",
                                            "example": "City"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/agent/online": {
            "get": {
                "tags": [
                    "Agent"
                ],
                "summary": "Get all connected clients",
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description":"Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type":"array",
                                    "items": {
                                        "$ref":"#/components/schemas/clients"
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/web/agent/file/get": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Get an agent file that is saved on the server",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/webAgentGet"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/files200"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "File could not be read",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type":"string",
                                            "example": "Error!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/web/agent/file/put": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Put a file for an agent on the server.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/webAgentPut"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type":"object",
                                    "properties": {
                                        "message": {
                                            "type":"string",
                                            "example":"Done!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "File could not be found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type":"object",
                                    "properties": {
                                        "error": {
                                            "type":"string",
                                            "example":"Error!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/api/web/user/file/get": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Get a user file from the server.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/webUserGet"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/files200"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "File could not be read",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type":"string",
                                            "example": "Error!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/web/user/file/put": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Put a user file on the server.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/webUserPut"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type":"object",
                                    "properties": {
                                        "message": {
                                            "type":"string",
                                            "example":"Done!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "File could not be found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type":"object",
                                    "properties": {
                                        "error": {
                                            "type":"string",
                                            "example":"Error!"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/api/agent/file/get": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Get file from an agent to the server",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/file"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "404": {
                        "description": "Could not find file",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref":"#/components/schemas/error404"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/agent/file/put": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Put file from server to an agent",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/file"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "404": {
                        "description": "Could not find file",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref":"#/components/schemas/error404"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/web/user/fileList": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Get a hierarchy of files for the user.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/userFileList"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/web/agent/fileList": {
            "post": {
                "tags": [
                    "Files"
                ],
                "summary": "Get a hierarchy of files for the specified agent.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/agentFileList"
                            }
                        }
                    }
                },
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful"
                    },
                    "400": {
                        "description": "Bad request body",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/error400"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid JWT token",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "$ref":"#/components/schemas/error403"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "screenshot": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example": "Agent"
                    },
                    "location": {
                        "type":"string",
                        "example":"City"
                    },
                    "ip": {
                        "type":"string",
                        "example":"0.0.0.0"
                    },
                    "user": {
                        "type":"string",
                        "example":"user@mail.com"
                    }
                }
            },
            "command": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "command": {
                        "type":"string",
                        "example":"dir"
                    },
                    "parameters":{
                        "type":"string",
                        "example":"Parameters"
                    },
                    "user": {
                        "type":"string",
                        "example":"user@mail.com"
                    }
                }
            },
            "agent": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "user": {
                        "type":"string",
                        "example":"user@mail.com"
                    }
                }
            },
            "webAgentGet": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    }
                }
            },
            "webAgentPut": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "path": {
                        "type": "string",
                        "example":"/"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    },
                    "base64Data": {
                        "type":"string"
                    }
                }
            },

            "webUserGet": {
                "type": "object",
                "properties": {
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    }
                }
            },
            "webUserPut": {
                "type": "object",
                "properties": {
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "path": {
                        "type": "string",
                        "example":"/"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    },
                    "base64Data": {
                        "type":"string"
                    }
                }
            },

            "userFileList": {
                "type": "object",
                "properties": {
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    }
                }
            },
            "agentFileList": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    }
                }
            },
            "file": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "path": {
                        "type":"string",
                        "example":"/"
                    },
                    "user": {
                        "type": "string",
                        "example":"user@mail.com"
                    }
                }
            },
            "disconnected": {
                "type":"object",
                "properties": {
                    "type": {
                        "type":"string",
                        "example":"Disconnected"
                    },
                    "user": {
                        "type":"string",
                        "example":"user@mail.com"
                    }
                }
            },
            "connected": {
                "type":"object",
                "properties": {
                    "type": {
                        "type":"string",
                        "example":"Connected"
                    },
                    "user": {
                        "type":"string",
                        "example":"user@mail.com"
                    }
                }
            },
            "clients": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "example":"Agent"
                    },
                    "location": {
                        "type": "string",
                        "example":"City"
                    },
                    "ip": {
                        "type": "string",
                        "example":"0.0.0.0"
                    },
                    "path": {
                        "type":"string",
                        "example":"/"
                    },
                    "status": {
                        "type":"string",
                        "example":"Connected"
                    }
                }
            },
            "error400": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string",
                        "example": "Erorr, got wrong json"
                    }
                }
            },
            "error403": {
                "type":"string",
                "example":"Token not valid"
            },
            "files200": {
                "type": "object",
                "properties": {
                    "fileName": {
                        "type": "string",
                        "example":"File"
                    },
                    "base64Data": {
                        "type": "string"
                    }
                }
            },
            "error404": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "string",
                        "example": "Device is not connected to the server!"
                    },
                    "name": {
                        "type":"string",
                        "example": "Agent"
                    },
                    "location": {
                        "type":"string",
                        "example": "City"
                    }
                }
            }
        },
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT"
            }
        }
    },
    "security": [
        {
            "bearerAuth": []
        }
    ]
}